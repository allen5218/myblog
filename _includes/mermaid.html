<style>
/* Mermaid CSS isolation - lightweight fixes only */
.language-mermaid {
  /* Override post-container img styles for mermaid SVGs */
  text-align: center;
  margin: 1.5em 0;
}

.language-mermaid svg {
  /* Fix SVG display issues */
  max-width: 100% !important;
  height: auto !important;
  display: block;
  margin: 0 auto !important;
}


/* Override blog link colors in mermaid diagrams */
.post-container .language-mermaid a {
  color: inherit !important;
  text-decoration: none !important;
}

.post-container .language-mermaid a:hover,
.post-container .language-mermaid a:focus {
  color: inherit !important;
}
</style>

<script src="https://cdn.jsdelivr.net/npm/mermaid@{{ site.mermaid_version }}/dist/mermaid.min.js"></script>
<script>
  // Mermaid 固定使用淺色主題
  mermaid.initialize({
    startOnLoad: true,
    securityLevel: 'loose',
    theme: 'default',
    flowchart: {
      useMaxWidth: false,
      htmlLabels: true
    }
  });
  
  // 初始化所有mermaid圖表
  mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
  
  // 在圖表渲染後處理甘特圖的橫向滾動
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(() => {
      document.querySelectorAll('.language-mermaid').forEach(container => {
        const svg = container.querySelector('svg');
        if (svg && svg.querySelector('g.grid')) {
          // 這是甘特圖，啟用橫向滾動
          container.style.overflowX = 'auto';
          container.style.webkitOverflowScrolling = 'touch';
          svg.style.maxWidth = 'none';
          svg.style.minWidth = '100%';
        }
      });
    }, 1000); // 等待圖表完全渲染
  });
</script>